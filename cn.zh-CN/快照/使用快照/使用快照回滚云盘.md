# 使用快照回滚云盘 {#concept_smh_y2l_xdb .task}

回滚磁盘常应用于系统故障、错误操作和应用版本回退等场景。回滚时，磁盘必须拥有至少一份历史快照。回滚系统盘后，默认自动绑定实例当前的密钥对或密码。

在使用快照回滚云盘前，请确认以下信息：

-   您已经为云盘创建快照，而且要回滚的云盘当前没有正在创建的快照。具体操作，请参见[创建快照](cn.zh-CN/快照/使用快照/创建快照.md#)。
-   云盘未被释放。
-   更换系统盘后，历史系统盘快照不能用于回滚新的系统盘。
-   云盘被用作创建动态扩展卷或者RAID阵列时，您必须预先停止所有I/O操作，再使用快照回滚云盘。
-   云盘必须已经挂载到某台ECS实例上，而且已经停止实例。具体操作，请参见[挂载云盘](../cn.zh-CN/块存储/云盘/挂载云盘.md#)和[启动和停止实例](../cn.zh-CN/实例/管理实例/启动和停止实例.md#)。

    **说明：** 对于按量付费的VPC类型实例而言，停机不收费模式下，回滚云盘后可能无法成功启动实例。建议您停止实例前先关闭**停机不收费**。具体操作，请参见[按量付费实例停机不收费](../cn.zh-CN/产品定价/按量付费实例停机不收费.md#)。


**警告：** 为避免误操作，建议您在回滚前为磁盘创建快照，便于系统恢复和数据提取。具体操作，请参见[创建快照](cn.zh-CN/快照/使用快照/创建快照.md#)。回滚云盘是不可逆操作，从快照的创建日期到回滚云盘时这段时间内的数据会丢失。请谨慎操作。

回滚云盘时，您可以从**快照**页面和**实例**页面进入操作界面。以下示例为从**实例**页面进入的操作步骤。

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。
2.  在左侧导航栏，选择**实例与镜像** \> **实例**。
3.  在顶部状态栏处，选择地域。
4.  找到需要回滚云盘的实例，在**操作**列中，单击**管理**。 

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9688/156643993339440_zh-CN.png)

5.  在左侧导航栏中，单击**本实例快照**。
6.  选择需要的快照，在**操作**列中，单击**回滚磁盘**。 

    **说明：** 单次只能回滚一块磁盘，实例上挂载的其他磁盘不受影响。回滚后，整块磁盘会恢复到某个时间点的状态，而不是某个分区或目录当时的状态。

7.  在弹出的对话框中，单击**确定**。 

    **说明：** 如果您选择**回滚后立即启动实例**，云盘回滚成功后，实例会自动启动。


如果在数据盘创建快照后，您做过扩容操作，回滚云盘后，您需要登录实例重新扩容文件系统。具体操作，请参见：

-   [扩容数据盘\_Linux](cn.zh-CN/块存储/云盘/扩容云盘/扩展分区和文件系统_Linux数据盘.md#)
-   [扩容数据盘\_Windows](cn.zh-CN/块存储/云盘/扩容云盘/扩展分区和文件系统_Windows.md#)

回滚云盘后，如果您需要同步数据，请按以下步骤操作。假设您已经在时间点一为原云盘创建了快照A。

1.  在时间点二，为原云盘创建快照B。具体操作，请参见[创建快照](cn.zh-CN/快照/使用快照/创建快照.md#)。
2.  使用快照A回滚原云盘。
3.  使用快照B创建新云盘。
4.  在同一实例上挂载新云盘。具体操作，请参见[挂载云盘](../cn.zh-CN/块存储/云盘/挂载云盘.md#)。
5.  远程连接实例。
6.  （可选）如果是Linux实例，运行`mount`命令挂载新云盘的分区。

    **说明：** 

    -   Windows实例：在系统中可以直接看到新增的云盘B。
    -   Linux实例：在控制台完成挂载操作后，还需要连接实例运行`mount`命令才能成功挂载云盘B。
7.  将新云盘中的有用数据复制到原云盘中。
8.  （可选）按需释放新云盘。

通过以上方式同步数据的流程图如下所示：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9688/156643993340777_zh-CN.png)

**相关文档**  


[ResetDisk](../cn.zh-CN/API参考/块存储/ResetDisk.md#)

