# 弹性供应组设置示例 {#concept_744276 .concept}

本文介绍设置弹性供应组时需要考虑的因素和实例集群部署过程，并以常见场景为例提供配置方案。

## 弹性供应组设置过程 {#section_vw0_65u_zwc .section}

您可以参考以下思路确定弹性供应组的设置细节，具体的设置项说明请参见[创建弹性供应组](cn.zh-CN/隐藏/管理弹性供应组/创建弹性供应组.md#)。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/236159/156110630148807_zh-CN.png)

## 实例集群部署过程 {#section_yq5_sbg_zme .section}

弹性供应组启动后即开始按照设置部署实例集群，典型过程如下：

1.  尝试满足抢占式实例和按量付费实例目标容量的要求。
    -   对抢占式实例：
        -   扩容策略为**成本优化策略**时，从备选实例规格中选取最便宜的规格创建实例。如果设置了**成本优化策略允许的规格数量**，选取最便宜的数个备选实例规格创建实例。例如，**成本优化策略允许的规格数量**为2，选取最便宜的2个备选实例规格创建实例。
        -   扩容策略为**均衡可用区分布策略**时，在您为备选实例规格设置的可用区之间均匀创建实例。

            **说明：** 回收抢占式实例时按实例规格进行，而且同一实例规格族内的实例资源共享。如果选用均衡可用区分布策略，建议您配置不同的实例规格族，避免所有实例同时被回收，保证实例集群的高可用性。

    -   对按量付费实例：
        -   扩容策略为**成本优化策略**时，从备选实例规格中选取最便宜的规格创建实例。
        -   扩容策略为**优先级策略**时，按照您为备选实例规格设置的优先级依次尝试创建实例。
2.  如果您定义的抢占式实例和按量付费实例目标容量未能达到集群目标容量要求，弹性供应组会继续按**差额容量实例的默认付费类型**创建实例。
3.  如果类型为**持续保持**，弹性供应组会不停比较实时容量和目标容量，如果未能达到任一目标容量，弹性供应组在出现可用资源时会创建实例满足容量需求。

## 机器学习场景示例 {#section_qfz_a7u_zsu .section}

假设您计划在未来一周完成一项机器学习任务，用于分析住房抵押贷款的风险因素，对实例集群的需求如下：

-   单节点最低计算力8 vCPU、60 GiB
-   集群目标计算力为单节点最低计算力的10倍
-   尽量节省成本，只用抢占式实例，可以接受集群规模不达标
-   任务结束后释放实例

考虑以上需求，确定配置如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/236159/156110630148841_zh-CN.png)

从上图可见，以下两个可选方案满足容量需求：

-   10台ecs.gn5-c8g1.2xlarge实例
-   5台ecs.gn5-c8g1.4xlarge实例

该弹性供应组使用成本优化策略创建抢占式实例，会比较使用两种方案交付实例集群所需的成本，并采用成本最低的方案一次性交付实例集群，集群规模未达标也不再重试。

## 购票网站场景示例 {#section_lse_fv9_c5r .section}

假设您需要搭建一个购票网站，提供覆盖日常和高峰时段的购票服务，对实例集群的需求如下：

-   单节点最低计算力8 vCPU、16 GiB
-   集群目标计算力为单节点最低计算力30倍
-   集群最低计算力为单节点最低计算力20倍
-   在集群最低计算力基础上优化网站访问体验，尽量节省成本
-   具有容灾能力

考虑以上需求，确定配置如下：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/236159/156110630148846_zh-CN.png)

使用均衡可用区分布策略创建抢占式实例。为满足均衡可用区分布的需求，弹性供应组会在每个可用区创建实例，但需要满足整体计算力需求，示例组合如下：

-   1台ecs.c5.2xlarge实例、2台ecs.c5.4xlarge实例、1台ecs.sn1ne.2xlarge实例和2台ecs.sn1ne.4xlarge实例
-   3台ecs.c5.2xlarge实例、1台ecs.c5.4xlarge实例、3台ecs.sn1ne.2xlarge实例和1台ecs.sn1ne.4xlarge实例

使用成本优化策略创建按量付费实例，从上图可见，以下四个可选方案满足容量需求：

-   20台ecs.c5.2xlarge实例
-   10台ecs.c5.4xlarge实例
-   20台ecs.sn1ne.2xlarge实例
-   10台ecs.sn1ne.4xlarge实例

弹性供应组会比较使用四种方案交付按量付费实例所需的成本，并采用成本最低的方案交付实例集群。

在持续保持模式下，弹性供应组不停比较实时容量和目标容量，如果抢占式实例创建失败或者被回收，会在出现可用资源时继续创建实例满足容量需求。

