# 创建弹性供应组 {#task_405815 .task}

本文介绍如何在控制台创建弹性供应组，部署符合要求的实例集群。

-   已授予账号操作弹性供应组相关云资源的权限，即首次进入弹性供应功能页面时，按提示授权系统RAM角色`AliyunECSAutoProvisioningGroupRole`。
-   已创建启动模板，详情请参见[创建实例启动模板](../../../../cn.zh-CN/实例/管理实例启动模板/创建实例启动模板.md#)。

1.  登录[ECS管理控制台](https://ecs.console.aliyun.com)。
2.  在左侧导航栏，选择**部署与弹性** \> **弹性供应**。
3.  在顶部状态栏处，选择地域。
4.  单击**创建供应组**。 请参见[弹性供应组设置过程](cn.zh-CN/隐藏/管理弹性供应组/弹性供应组设置示例.md#section_vw0_65u_zwc)了解设置项间关系。
5.  设置供应组。 
    1.  设置基本信息。 

        |参数|说明|
        |--|--|
        |**供应组名称**|弹性供应组的名称。命名规则：长度为 2~128 个英文或中文字符。必须以大小字母或中文开头，不能以 http:// 和 https:// 开头。可以包含数字、半角冒号（:）、下划线（\_）或者连字符（-）。|
        |**供应组类型**|         -   **一次性交付**：弹性供应组启动后尝试创建指定容量的实例集群。只尝试创建一次，如果任务失败，不会重试。
        -   **持续保持**：弹性供应组启动后尝试创建指定容量的实例集群。弹性供应组会持续比较实时容量和目标容量，如果存在差距则尝试创建实例满足容量需求。
 |
        |**生效于**|弹性供应组的启动时间，和**结束于**结合使用，确定弹性供应组的有效时段。         -   **立即生效**：创建成功后立即开始执行调度任务。
        -   自定义生效时间。
 |
        |**结束于**|弹性供应组的过期时间，和**生效于**结合使用，确定弹性供应组的有效时段。         -   **无限期**：弹性供应组不会过期。
        -   自定义过期时间。
 |

    2.  设置供应组容量。 

        |参数|说明|
        |--|--|
        |**目标容量**|集群的总目标容量，由三部分组成：         -   抢占式实例所占的容量
        -   按量付费实例所占的容量
        -   差额容量。根据您设置的**差额容量实例的默认付费类型**判断使用何种实例补齐差额容量。
 |
        |**抢占式实例的目标容量**|**目标容量**中抢占式实例所占的部分。|
        |**按量实例的目标容量**|**目标容量**中按量付费实例所占的部分。|

    3.  完成容量相关设置。 **容量相关设置**是一组调度策略，弹性供应组根据调度策略执行调度任务，部署指定容量的实例集群，备选实例规格由[模板设置](#step_2an_zh2_jvy)决定。

        |参数|说明|
        |--|--|
        |**差额容量实例的默认付费类型**|如果抢占式实例目标容量和按量付费实例目标容量之和小于集群的总目标容量，弹性供应组会创建所选类型的实例满足容量需求。|
        |**按量实例的扩容策略**|创建按量付费实例时遵循的策略，可选项：         -   **成本优化策略**：在备选实例规格中选择创建成本最低的实例。
        -   **优先级策略**：按指定的优先级尝试创建实例。如果您选择了此策略，需要在下一步的**是否扩展启动模板**中设置优先级，详情请参见[模板设置](#step_2an_zh2_jvy)。

**说明：** 如果您使用预留实例券匹配实例，建议您选择优先级策略，并将预留实例券可匹配的实例规格设为高优先级。匹配成功后，预留实例券会自动抵扣按量付费实例的账单，更多信息请参见[预留实例券匹配规则](../../../../cn.zh-CN/实例/选择实例购买方式/预留实例券/预留实例券匹配规则.md#)。

 |
        |**抢占式实例的扩容策略**|创建按量抢占式实例时遵循的扩容策略，可选项：         -   **成本优化策略**：在备选实例规格中选择成本最低的实例规格。选择此策略后，您还可以设置**成本优化策略允许的规格数量**，使用成本最低的数个实例规格。
        -   **均衡可用区分布策略**：在可购买备选实例规格的可用区之间，均匀部署实例。

**说明：** 回收抢占式实例时按实例规格进行，而且同一实例规格族内的实例资源共享。如果选用均衡可用区分布策略，建议您配置不同的实例规格族，避免所有实例同时被回收，保证实例集群的高可用性。

 |
        |**成本优化策略允许的规格数量**|和抢占式实例的**成本优化策略**结合使用，弹性供应组会使用成本较低的数个实例规格创建抢占式实例。|
        |**抢占式实例关停策略**|弹性供应组过期或超过容量时，弹性供应组内抢占式实例的动作，必须和**供应组过期时是否关停供应组内实例**及**超过容量时是否关停供应组内实例**结合使用，可选项：         -   **停机**：实例停机后，数据将保留。
        -   **释放**：实例释放后，数据不保留，且无法恢复。
 |
        |**设置全局的抢占式实例上限价格**|创建抢占式实例时可以承受的最高价格，适用于所有实例规格。创建实例时，如果和单台实例规格上限价格不一致，以较低者为准。|
        |**供应组过期时是否关停弹性供应组内实例**|超过有效时段时，对弹性供应组内的实例的处理策略。开启后，会根据**抢占式实例关停策略**判断停机或释放实例。|
        |**超过容量时是否关停供应组内实例**|弹性供应组内实际存在的实例超出容量时，对超额实例的处理策略。开启后，会根据**抢占式实例关停策略**判断停机或释放实例。|

6.  单击**下一步：模板设置**。
7.  完成模板设置。 模板设置包括指定弹性供应组关联的实例启动模板以及扩展启动模板，用于确定一组备选实例规格。启动弹性供应组后实际创建的实例规格由[容量相关设置](#step_bc2_7bj_ai6)决定。
    1.  选择启动模板。 此处利用了实例启动模板的能力，您可以指定启动模板和版本，更多信息请参见[什么是实例启动模板](../../../../cn.zh-CN/实例/管理实例启动模板/什么是实例启动模板.md#)。
    2.  设置扩展启动模板。 启动模板仅指定了一个实例规格，选择范围较窄。通过扩展启动模板，您可以扩展选择范围。为提高调度成功率，您必须至少指定一个扩展启动模板。

        |参数|说明|
        |--|--|
        |**可用区**|选择其它可用区，和**虚拟交换机**结合使用，确定备选实例规格的位置。|
        |**虚拟交换机**|选择其它虚拟交换机，和**可用区**结合使用，确定备选实例规格的位置。|
        |**实例规格**|您可以从实例规格族相同、vCPU相同、内存相同三个维度选择多个实例规格，打造适用于相同场景的备选实例规格集合，扩展选择范围，提高调度成功率。|
        |**设置单台实例规格上限价格**|创建指定规格的实例时可以承受的最高价格，如果和全局抢占式实例规格上限价格不一致，以较低者为准。|
        |**实例规格的容量权重**|权重根据指定实例规格的计算力和集群单节点最低计算力得出。权重越大，单台实例满足计算力需求的能力越大，所需的实例数量越小。例如，单节点最低计算力为8 vCPU、60 GiB，则8 vCPU、60 GiB的实例规格权重为1，16 vCPU、120 GiB的实例规格权重为2。|
        |**优先级**|与按量付费实例的**优先级策略**配合使用，0最高，随着数字增大依次降低。创建按量付费实例时会优先尝试优先级较高的实例规格。|

    3.  单击**确认**。
8.  单击**下一步：确认创建**。
9.  确认供应组设置和模板设置，然后单击**完成创建**。

弹性供应组创建成功后，会在您指定的时间启动并尝试交付实例集群。如果选择了**持续保持**模式，还会持续维护实例集群，在抢占式实例被回收时尝试创建新的实例，缩小实时容量和目标容量的差距，并及时替换不健康的实例。

