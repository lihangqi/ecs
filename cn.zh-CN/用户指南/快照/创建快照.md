# 创建快照 {#concept_eps_gbl_xdb .concept}

快照可以保留某一时间点的磁盘数据状态，常用于数据备份和制作自定义镜像。

## 使用场景 {#section_ewp_wyx_52b .section}

创建快照是极为重要的操作，在有操作风险的场景中，您可以提前创建快照备份数据。例如修改关键系统文件、实例从 [经典网络迁移至专有网络VPC](../../../../../cn.zh-CN/最佳实践/经典网络迁移到VPC/迁移方案概述.md#)、日常数据备份、实例误释放恢复、预防网络攻击、[更换操作系统](cn.zh-CN/用户指南/实例/更换操作系统.md#)、为某些生产环境提供数据支撑和其他具有操作风险的场景。

快照还可以 [制作自定义镜像](cn.zh-CN/用户指南/镜像/创建自定义镜像/使用快照创建自定义镜像.md#)，在大量ECS实例中快速部署应用环境。

## 注意事项 {#section_azs_vyx_52b .section}

**说明：** 

自2017年3月28日起，ECS快照正式商业化并纳入收费服务，计费详情请参阅 [快照计费方式](../../../../../cn.zh-CN/产品定价/快照计费方式.md#)。关于快照收费的更多信息，请参阅 [快照商业化FAQ](https://help.aliyun.com/document_detail/52045.html)。

-   创建快照可能会轻微降低磁盘的性能，I/O性能短暂变慢。您需要避开业务高峰。
-   快照只会备份某一时刻的数据，创建快照期间，操作磁盘产生的增量数据不会同步到快照中。
-   为保证成功创建快照，创建快照时，您不能修改ECS实例状态，比如停止或重启ECS实例。
-   根据实例创建快照时，实例必须处于 **运行中** 或 **已停止** 状态。
-   根据磁盘创建快照时，磁盘必须处于 **使用中** 状态。
-   您自行创建的快照会一直保留，请定期 [删除](cn.zh-CN/用户指南/快照/删除快照和自动快照策略.md#) 不再需要的快照，以免快照容量持续扣费。
-   如果您使用多分区的单磁盘制作了扩展卷，创建的快照可以正常 [回滚磁盘](cn.zh-CN/用户指南/云盘/回滚云盘.md#)。
-   使用多磁盘制作了动态扩展卷后，扩展卷中数据无I/O操作时，创建的快照可以正常回滚磁盘。如果扩展卷中一直有I/O操作，则回滚后的磁盘无法保证数据的完整性。

## 控制台操作步骤 {#section_pdn_xdl_xdb .section}

在ECS管理控制台上创建快照的步骤如下：

1.  登录 [ECS管理控制台](https://ecs.console.aliyun.com/)。
2.  选择地域。
3.  在左侧导航栏，单击 **实例**。
4.  找到需要创建快照的实例，单击 **管理**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9687/15500372419505_zh-CN.png)

5.  单击左侧 **本实例磁盘**，然后单击对应磁盘右侧的 **创建快照**。一次只能选择一块磁盘，**磁盘属性** 可以是系统盘和数据盘。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9687/15500372414530_zh-CN.png)

6.  输入快照的名称，单击 **确定**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9687/15500372414550_zh-CN.png)

7.  单击左侧 **本实例快照** 查看快照任务。您可以看到快照进度、预计剩余时间和快照状态。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/9687/15500372414552_zh-CN.png)


## API操作步骤 {#section_rn1_hys_lgb .section}

**说明：** 

本文调用API的工具为阿里云CLI，请确保您已[安装](https://help.aliyun.com/document_detail/90765.html)和[配置](https://help.aliyun.com/document_detail/90766.html)了阿里云CLI。

1.  获取实例ID。
    -   如果您已远程连接到ECS实例，可以通过[实例元数据](cn.zh-CN/用户指南/实例/实例自定义数据和元数据/实例元数据.md#)获取实例ID：

        ```
        curl http://100.100.100.200/2016-01-01/meta-data/instance-id
        ```

    -   在本地计算机中，您可以通过[DescribeInstances](../../../../../cn.zh-CN/API参考/实例/DescribeInstances.md#)获取实例ID：

        ```
        aliyun ecs DescribeInstances --output cols=InstanceId,InstanceName
        ```

2.  使用[DescribeInstances](../../../../../cn.zh-CN/API参考/实例/DescribeInstances.md#)筛选磁盘ID：

    ```
    aliyun ecs DescribeInstances --RegionId cn-hangzhou --InstanceId i-bp1afnc98r8k69XXXXXX --output cols=DiskId
    ```

3.  使用[CreateSnapshot](../../../../../cn.zh-CN/API参考/快照/CreateSnapshot.md#)根据磁盘ID创建快照：

    ```
    aliyun ecs CreateSnapshot --DiskId d-bp19pjyf12hebpXXXXXX
    ```

    返回以下信息时，表示已成功发起创建任务：

    ```
    {"RequestId":"16B856F6-EFFB-4397-8A8A-CB73FAXXXXXX","SnapshotId":"s-bp1afnc98r8kjhXXXXXX"}
    ```

4.  使用[DescribeSnapshots](../../../../../cn.zh-CN/API参考/快照/DescribeSnapshots.md#)查询快照创建状态。当`"SnapshotId"="s-bp1afnc98r8kjhXXXXXX"`和`"Status":"accomplished"`同时出现，表示快照已成功创建：

    ```
    aliyun ecs DescribeSnapshots --RegionId cn-hangzhou --InstanceId i-bp1afnc98r8k69XXXXXX --output cols=SnapshotId,Status
    ```


## 所需时间 {#section_gvs_ydl_xdb .section}

创建一份快照的所需时间主要取决于磁盘容量大小。

根据快照的 [增量原理](../../../../../cn.zh-CN/产品简介/快照/原理介绍.md#)，磁盘的第一份快照为全量快照，耗时较久。再次创建快照，相对耗时较短，但依然取决于和上一份快照之间的数据变化量。变化越大，耗时越久。

## 下一步 {#section_mx4_cyy_52b .section}

创建快照后，您可以继续以下操作：

-   [回滚云盘](cn.zh-CN/用户指南/云盘/回滚云盘.md#)
-   [用快照创建云盘](cn.zh-CN/用户指南/云盘/用快照创建云盘.md#)
-   [使用快照创建自定义镜像](cn.zh-CN/用户指南/镜像/创建自定义镜像/使用快照创建自定义镜像.md#)

